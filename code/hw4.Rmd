---
title: "Homework_4_SecondTry"
author: "Jacob Coggshall"
date: "2023-05-27"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, warning = FALSE, message = FALSE)
```

# Loading In Packages

```{r}
library(tidyverse)
library(naniar)
library(here)
library(janitor)
library(ggplot2)
library(dplyr)
library(gridExtra)
```

```{r}
fishdata <- read.csv(
  here("data", "ntl6_v12.csv"))|>
  clean_names()|>
  filter(spname == "TROUTPERCH") |>
  filter(!is.na(weight))
```

### Biological terms:
H0: Fish length does not predict fish weight for trout perch across all sample years.
HA: Fish length predicts fish weight for trout perch across all sample years.

### Standard
Null hypothesis (H0): There is no significant relationship between fish length (L) and fish weight (W) for trout perch across all sample years.

Alternative hypothesis (HA): There is a significant relationship between fish length (L) and fish weight (W) for trout perch across all sample years.

### Mathmatical
H0: The coefficient of fish length in the linear regression model is equal to zero.
HA: The coefficient of fish length in the linear regression model is not equal to zero.


# Checking missing variable
```{r}
gg_miss_var(fishdata)
```

The missing data is not relevant to our hypotheses because we have filtered out all the rows where there was no reading for the weight of trout perch. By removing the rows with missing weight values, we ensure that our analysis includes only complete data points, allowing us to examine the relationship between fish length and fish weight without the confounding effect of missing values.



```{r}
t_test_result <- t.test(fishdata$length, fishdata$weight)

t_test_result
```

```{r}
cor_result <- cor.test(fishdata$length, fishdata$weight)

print(cor_result)
```

# Testing Linearity

```{r}
linear <- ggplot(data = fishdata, aes(x = length, y = weight)) +
  geom_point() +
  geom_smooth(method = "lm", se = TRUE) +
  labs(x = "Fish Length", y = "Fish Weight",
       title = "Plot of Fish Length vs. Fish Weight")
```

# Testing Normalilty

```{r}
# Create a histogram
histo <- ggplot(data = fishdata, aes(x = weight)) +
  geom_histogram(binwidth = 1, fill = "lightblue", color = "black") +
  labs(x = "Fish Weight", y = "Frequency",
       title = "Histogram of Fish Weight")

# Create a Q-Q plot
qq <- ggplot(data = fishdata, aes(sample = weight)) +
  stat_qq() +
  stat_qq_line() +
  labs(x = "Theoretical Quantiles", y = "Sample Quantiles",
       title = "Q-Q Plot of Fish Weight")
```

# Testing Homoscedasticity

```{r}

# Fit a linear regression model
lm_model <- lm(weight ~ length, data = fishdata)

# Extract the residuals and predicted values
residuals <- lm_model$residuals
predicted_values <- predict(lm_model)

# Create a data frame with predicted values and residuals
residual_df <- data.frame(Predicted = predicted_values, Residuals = residuals)

# Create a scatter plot of residuals against predicted values
scatter <- ggplot(data = residual_df, aes(x = Predicted, y = Residuals)) +
  geom_point() +
  labs(x = "Predicted Values", y = "Residuals",
       title = "Residuals vs. Predicted Values Plot")

```

```{r}
# Load the necessary packages
library(gridExtra)

# Arrange the plots in a grid layout
full_grid <- grid.arrange(qq, scatter, histo, linear,ncol = 2, nrow = 2, widths = c(5, 7))
```

The scatter plot with a trendline shows the relationship between fish length and fish weight. By visually analyzing the plot, we can observe the general trend and determine that there is a positive or negative correlation between the two variables.


The scatter plot of residuals against predicted values shows the distribution of the residuals across the range of predicted values. By examining the plot, we can assess that there is no significant deviation in the residuals.

The histogram of fish weight displays the frequency distribution of fish weights, allowing us to observe the distribution's shape and any potential outliers. After examining the plot, we can determine the data is skewed to the left, indicating generally lower weights.


The Q-Q plot compares the observed fish weight data to a theoretical normal distribution. If the data points fall approximately along a straight line, it suggests that the data follows a normal distribution. Deviations from the straight line may indicate departures from normality or systematic biases in the data.This dat looks generally normally distributed

```{r}
summary(fishdata)
```

The summary results indicate that the data consists of 290 observations collected annually from eleven primary lakes (Trout, Perch) (sampling frequency: annually, number of sites: 11). The year variable ranges from 1981 to 2022, with a median year of 1998. The depth variable ranges from -1.0000 to 1.0000, with a mean depth of -0.9931. The replicate number ranges from 1 to 19, with a median of 4. The length variable ranges from 54.00 to 120.00, with a mean length of 85.52. The weight variable ranges from 1.000 to 18.000, with a mean weight of 5.388. The study employed various sampling methods, including seine, traps, electrofishing, gill nets, and trammel nets, to capture fish species and obtain measurements like lengths and weights.

