---
title: "Homework_4_SecondTry"
author: "Jacob Coggshall"
date: "2023-05-27"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, warning = FALSE, message = FALSE)
```

# Loading In Packages

```{r}
library(tidyverse)
library(naniar)
library(here)
library(janitor)
library(ggplot2)
library(dplyr)
```

```{r}
fishdata <- read.csv(
  here("data", "ntl6_v12.csv"))|>
  clean_names()|>
  filter(spname == "TROUTPERCH") |>
  filter(!is.na(weight))
```

### Biological terms:
H0: Fish length does not predict fish weight for trout perch across all sample years.
HA: Fish length predicts fish weight for trout perch across all sample years.

### Standard
Null hypothesis (H0): There is no significant relationship between fish length (L) and fish weight (W) for trout perch across all sample years.

Alternative hypothesis (HA): There is a significant relationship between fish length (L) and fish weight (W) for trout perch across all sample years.

### Mathmatical
H0: The coefficient of fish length in the linear regression model is equal to zero.
HA: The coefficient of fish length in the linear regression model is not equal to zero.


# Checking missing variable
```{r}
gg_miss_var(fishdata)
```

The missing data is not relevant to our hypotheses because we have filtered out all the rows where there was no reading for the weight of trout perch. By removing the rows with missing weight values, we ensure that our analysis includes only complete data points, allowing us to examine the relationship between fish length and fish weight without the confounding effect of missing values.



```{r}
t_test_result <- t.test(fishdata$length, fishdata$weight)

t_test_result
```

```{r}
cor_result <- cor.test(fishdata$length, fishdata$weight)

print(cor_result)
```

# Testing Linearity

```{r}
ggplot(data = fishdata, aes(x = length, y = weight)) +
  geom_point() +
  geom_smooth(method = "lm", se = TRUE) +
  labs(x = "Fish Length", y = "Fish Weight",
       title = "Scatter Plot of Fish Length vs. Fish Weight")
```

# Testing Normalilty

```{r}
# Create a histogram
ggplot(data = fishdata, aes(x = weight)) +
  geom_histogram(binwidth = 1, fill = "lightblue", color = "black") +
  labs(x = "Fish Weight", y = "Frequency",
       title = "Histogram of Fish Weight")

# Create a Q-Q plot
ggplot(data = fishdata, aes(sample = weight)) +
  stat_qq() +
  stat_qq_line() +
  labs(x = "Theoretical Quantiles", y = "Sample Quantiles",
       title = "Q-Q Plot of Fish Weight")
```

# Testing Homoscedasticity

```{r}

# Fit a linear regression model
lm_model <- lm(weight ~ length, data = fishdata)

# Extract the residuals and predicted values
residuals <- lm_model$residuals
predicted_values <- predict(lm_model)

# Create a data frame with predicted values and residuals
residual_df <- data.frame(Predicted = predicted_values, Residuals = residuals)

# Create a scatter plot of residuals against predicted values
ggplot(data = residual_df, aes(x = Predicted, y = Residuals)) +
  geom_point() +
  labs(x = "Predicted Values", y = "Residuals",
       title = "Residuals vs. Predicted Values Plot")

```

